$def with (author=None, limit=50)

$ _ = _.get_namespace('macros/RecentChanges')

$ page = safeint(query_param('rc_page', '0'))
$ changes = get_recent_changes(ctx.site, author=author, limit=limit)

$var title: Recent Changes
$var islist: true

</p>

<div id="bibliography">
<div id="browse-rule"></div>
<div id="biblio-form-body">

<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr>
  <td class="historyheader">When</td>
  <td class="historyheader">Path</td>
  <td class="historyheader">Who</td>
  <td class="historyheader" width="100%">What</td>
  <td class="historyheader">Actions</td>
</tr>

$for v in changes:
        <tr>
        <td class="time" valign="top">$datestr(v.created)</td>
        <td class="path" valign="top"><div class="truncatepath"><a href="$homepath()/$v.thing.name" class="datalink" title="$v.thing.name">$v.thing.name</a><span class="ellipsis">&nbsp;</span></div></td>
        $if v.author:
            <td class="displayname" valign="top"><div class="truncatedisplayname"><a href="$homepath()/$v.author.name" class="truncate" title="$v.author.get('displayname', 'no displayname')">$v.author.get('displayname', 'no displayname')</a><span class="ellipsis">&nbsp;</span></div></td>
        $else:
            <td class="history" valign="top">$v.ip</td>
        <td class="comment" valign="top">$v.comment</td>
        <td class="buttons" valign="top">
        <a href="$homepath()/$v.thing.name?m=view&v=$v.revision">$_.view</a>&nbsp;-&nbsp;<a href="$homepath()/$v.thing.name?m=edit&v=$v.revision">$_.edit</a>&nbsp;-&nbsp;<a href="$homepath()/$v.thing.name?m=diff&b=$v.revision">$_.diff</a>&nbsp;
        </td>
        </tr>
</table>

</div>
</div>

<div>
$if page != 0:
    <a href="$:changequery(rc_page=page - 1)">Newer</a>

$if len(changes) == limit:
    <a href="$:changequery(rc_page=page + 1)">Older</a>
<div>

