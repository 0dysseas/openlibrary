$def with (author=None, limit=50)

$ _ = _.get_namespace('/macros/RecentChanges')

$ page = safeint(query_param('page', '0'))
$ changes = get_recent_changes(author=author, limit=limit, offset=page * limit)

<!--islist-->

<div id="bibliography">
    <div id="browse-rule"></div>
    <div id="biblio-form-body">

        <table cellpadding="0" cellspacing="0" border="0" width="100%">
            <tr>
                <td class="historyheader">$_.when</td>
                <td class="historyheader">$_.path</td>
                <td class="historyheader">$_.who</td>
                <td class="historyheader" width="100%">$_.what</td>
                <td class="historyheader">$_.actions</td>
            </tr>

            $for v in changes:
                <tr>
                    <td class="time" valign="top">$datestr(v.created)</td>
                    <td class="path" valign="top"><div class="truncatepath"><a href="$homepath()$v.key" class="datalink" title="$v.key">$v.key</a><span class="ellipsis">&nbsp;</span></div></td>
                    $if v.author:
                        <td class="displayname" valign="top"><div class="truncatedisplayname"><a href="$homepath()$v.author.key" class="truncate" title="$v.author.displayname">$v.author.displayname</a><span class="ellipsis">&nbsp;</span></div></td>
                    $else:
                        <td class="history" valign="top">$v.ip</td>
                    <td class="comment" valign="top">$v.comment</td>
                    <td class="buttons" valign="top">
                        <a href="$homepath()$v.key?m=view&v=$v.revision">$_.view</a> -
                        <a href="$homepath()$v.key?m=edit&v=$v.revision">$_.edit</a> - 
                        <a href="$homepath()$v.key?m=diff&b=$v.revision">$_.diff</a>
                    </td>
                </tr>
        </table>
    </div>
</div>

<div class="copyright-footer">
$if page != 0:
    &larr; <a href="$:changequery(page=page - 1)" class="datalink" rel="nofollow">$_.newer</a>
    
$if len(changes) == limit:
    ... <a href="$:changequery(page=page + 1)" class="datalink" rel="nofollow">$_.older</a> &rarr;
</div>