$def with (page)

$ _t = _.get_namespace('/type/edition')
$ _ = _.get_namespace('/mode/view')

$ title = page.title_prefix + join(": ", [page.title] + page.subtitles)

$var title: $title

$add_stylesheet('/static/css/results.css')
$add_stylesheet('/static/css/doc-styles.css')

<blockquote class="text">
    <div id="header">
        <div id="title" class="title-pad">$title</div>
        <div id="statement">
            by <a href="" class="datalink">$:thingrepr(page.authors)</a><br />		
        </div>

        <div id="book-art" class="datalink">
            <img src="http://ecx.images-amazon.com/images/I/21C0JTG6V6L.jpg" width="180" alt="Cover Image" />
            <div id="book"></div>
            <br clear="all" />
        </div>
    </div>

    <div id="content-right">
        <div id="nav">
            <div id="options" style="margin-top: -20px;">
                <div class="navouter" style="padding-top: 0px;">
                    <img src="nav.top.png" alt="" border="0" />
                    <div class="navinner">
                        <div class="navinner-padding" style="font-size: 12px;">
                            <span class="navheader">Buy</span> <br />
                            <div class="navsubheader">
                            	<a href="#" class="datalink">Alibris</a><br />
                            	<a href="#" class="datalink">Amazon</a><br />
                            	<a href="#" class="datalink">AbeBooks</a><br />
                            	<a href="#" class="datalink">Barnes and Noble</a><br />
                            	<a href="#">Booksense</a><br />
                            	<a href="#" class="datalink">Powells</a>
                            </div>
                            <br />
                            
                            <span class="navheader">Borrow</span> <br />
                            <div class="navsubheader">
                                <a href="#" class="datalink">BookMooch</a><br />
                                <a href="#" class="datalink">Title Trader</a><br />
                                <a href="#" class="datalink">Worldcat</a><br />
                            </div>
                            <br />
                            
                            <span class="navheader">Download</span> <br />
                            <div class="navsubheader">
                                <a href="http://worldcat.org/isbn/0676973655" class="datalink">Internet Archive</a><br />
                            </div>
                            <br />
                        </div>
                    </div>

                    <div style="padding-top: 10px">
                        <span class="book-details-italic">
                            Data comes from <a href="http://www.amazon.com/" class="sidebar">Amazon</a>, 
                            <a href="http://www.loc.gov/" class="sidebar">Library of Congress</a>, and 
                            <a href="http://demo.openlibrary.org/users/" class="sidebar">users like you</a>.
                        </span>
                        <br />
                    </div>
                    <img src="/static/images/nav.bot.png" alt="" border="0" />
                </div>
            </div>
        </div>
    </div>

    <div>
        <div id="header">
            <table border="0" cellpadding="0" cellspacing="0">

                $ s0 = ["publish_date", "publishers", "publish_places"]
                $ s1 = ["work_titles", "by_statements", "series", "languages", "edition_name", "physical_format", "physical_dimensions"]
                $ s2 = ["isbn_10", "isbn_13", "lccn", "dewry_decimal_class", "lc_classifications"]
                $ s3 = ["genres", "subjects"]
                $ sections = [s0, s1, s2, s3]

                $ rule = "-top"

                $for s in sections:
                    $for name in s:
                        <tr>
                            <td class="formheader$rule">$_t[name]:</td>
                            <td class="formfield$rule">$:thingrepr(page[name])</td>
                        </tr>
                        $ rule = ""
                     $ rule = "-rule"

            </table>
            <br clear="all" />

            <div class="toc-header" style="border-bottom: 1px solid #ccc">
                <b>Description</b>
                <div style="padding-top: 0px; margin-top: -35px; float: right;">
                    <img src="/static/images/flourish.left.gif"  alt="[" /><button type="submit" name="submit" value="submit" class="edition" onclick="window.location='$:changequery(m='edit')'">Edit</button><img src="/static/images/flourish.gif"  alt="]" />
                </div>
            </div>
            <br />
            
            $page.description
            <br /><br />
            <b>Notes:</b> $page.notes

            <div class="toc-header" style="padding-top: 35px;">
                <b>Table of Contents</b>
                <div style="padding-top: 0px; float:right; margin-top: -25px;">
                    <img src="/static/images/flourish.left.gif"  alt="[" /><button type="submit" name="submit" value="edit" class="edition" onclick="window.location='$:changequery(m='edit')'">Edit</button><img src="/static/images/flourish.gif"  alt="]" />
                </div>
            </div>


            <div style="padding-top: 10px;">
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    $ first = "first"
                    $for i, toc in enumerate(page.toc):
                        <tr>
                            <td class="toc-number rule $first"><a href="#anchor1">$(i + 1)</a>&nbsp;&nbsp;</td>
                            <td class="toc rule $first" width="100%">$toc</td>
                            <td class="toc-link-end rule $first" align="center">&nbsp;&nbsp;</td>
                        </tr>
                        $ first = ""
                </table>
            </div>
              
        </div>
    </div>
</div>