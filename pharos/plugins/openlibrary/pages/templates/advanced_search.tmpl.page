{'type': {'name': 'type/template'}, 'name': 'templates/advanced_search.tmpl', 'd': {'body': '$def with (q, qresults, results, facets, ftokens, ft_pairs, errortext)\r\n\r\n$var title: Search Results\r\n\r\n$add_stylesheet(\'/static/css/search.css\')\r\n\r\n<div id="databar">\r\n<div class="widgetlabel">\r\n<b>Selected Facets:</b> \r\n$for token, tpair in ft_pairs:\r\n    $ name = tpair[0]\r\n    $ label = tpair[1]\r\n    <b>$name:</b> $:macros.HasFulltext(name, label)\r\n    <a href="$changequery(remove=token, ftokens=ftokens)" title="Remove this facet">(x)</a>\r\n     &nbsp;<b>&gt;</b>&nbsp;\r\n</div>\r\n</div>\r\n$:macros.AlertTour()\r\n\r\n$# check for the presence of a facet token corresponding to a fulltext search selection facet\r\n$# this is kludgy and maybe it should be done some other way, like with another plugin function\r\n$ want_fulltext = \'\'\r\n$if \'mhsncqbxgkup\' in ftokens:\r\n    $ want_fulltext = \'checked\'\r\n\r\n<table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td>\r\n\r\n<div id="header-fullpage">\r\n  <span id="title">Search Results</span><br />\r\n  \r\n  <form method="get" action="/search">\r\n  <input type="hidden" name="go" value="go">\r\n  <table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td>\r\n  <div class="simple-search-form"><input style="background-color: #f8f8f8; font-family: georgia; font-size: 18px; color: #6F320D; border: 1px solid #ccc; padding-left: 4px;" type="text" name="q" value="$q" size="38" title="Type your search terms here." /></div>\r\n  </td><td width="100%">\r\n<button class="button" type="submit"><img src="/static/images/go.png" alt="go" /></button>\r\n  </td>\r\n</tr><tr>\r\n<td colspan="2"><span class="copyright">Showing $qresults.begin - $(qresults.begin + 20) of $qresults.total_results\r\n<img src="/static/images/arrow.red.png" alt="Disclosure Arrow" /><span class="attention-emphasis"><input tabindex="9" type="checkbox" value="mhsncqbxgkup" name="ftokens" $want_fulltext> Fulltext items only </span></span></td>\r\n</tr></table></form>\r\n</div>\r\n\r\n    <p style="font-family: georgia; font-size: 18px;  margin-left: 30px;">The following books contain the words <span style="color: #6F320D;">$q</span>:</p>\r\n\r\n<div style="padding-left: 45px;"> \r\n   $:macros.SearchResults(results)\r\n </div>   \r\n    \r\n  \r\n\r\n<!-- BEGIN FACETS --> \r\n\r\n</td><td valign="top">\r\n\r\n$if errortext:\r\n    <div id="error">Error: $errortext</div>\r\n$else:\r\n\r\n    <div id="search-nav">\r\n    <div id="search-options">\r\n    <div class="search-outer">\r\n    <div style="width: 100%; text-align: center;"><img src="/static/images/nav.top.search.png" alt="Refine Results" border="0" /></div>  \r\n\r\n    $for facet in facets:\r\n        $ fname = facet[0]\r\n        $ fn1 = fname\r\n        $if fname == \'has_fulltext\':\r\n            $ fn1 = \'full text\'\r\n        $elif fname == \'facet_year\':\r\n            $ fn1 = \'date range\'\r\n        $ fentries = facet[1]\r\n        <div class="search-inner"><span class="refinesearch">$fn1:</span>\r\n        <div class="refineindent">\r\n        $for fentry in fentries[slice(5)]:\r\n            $ fval = fentry[0]\r\n            $ fcount = fentry[1]\r\n            $ ftoken = facet_token(fname, fval)\r\n            <a class="datalink" href="$changequery(ftokens=ftokens + \',\' + ftoken, remove=\'\')">$:macros.HasFulltext(fname, fval)</a> ($fcount)<br />\r\n        </div></div>\r\n\r\n\r\n</div></div></div>        \r\n</td></tr></table>        \r\n    \r\n  <div class="pagination">\r\n    <div class="moreresults"><strong>More Results:</strong></div>\r\n    <div class="paginate">\r\n    $if (qresults.begin - 1000) > 0: ...\r\n    $for n in range(qresults.begin - 1000, qresults.begin + 1000, 20):\r\n        $if (n >= 0) and (n <= qresults.total_results):\r\n            $if n == qresults.begin:\r\n                $if n != 0: | \r\n                <strong>$n - $(n + 20)</strong>\r\n            $else:\r\n                $if n != 0: | \r\n                <a href="$changequery(offset=n)">$n - $(n + 20)</a>\r\n    $if (qresults.begin + 1000) < qresults.total_results: | ...\r\n        </div>\r\n    </div>', 'title': 'advanced search template'}}