$def with (author=None, limit=1)

$ _ = i18n.get_namespace('/mode/view')

$ changes = get_recent_changes(author=author, limit=limit)

<div id="databar">
<div class="widgetlabel">
$if changes:
    $ v = changes[0]
    $if v.author:
        $ who = v.author.displayname or v.author.key
    $else:
        $ who = v.ip
    $if v.thing.type.key == '/type/edition':
        $ what = v.thing.title
    $elif v.thing.type.key == '/type/author':
        $ what = v.thing.name
    $else:
        $ what = v.key
    $ when = datestr(v.created)
    $if v.comment:
        $ comment = ": " + v.comment[0:50]
    $else:
        $ comment = ""
    <b>$_.whats_new:</b> $who updated $what $when $comment
</div>
</div>